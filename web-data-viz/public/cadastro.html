<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CCM Cadastro</title>
  <link rel="stylesheet" href="../css/general.css">
  <link rel="stylesheet" href="../css/folder.css">
</head>

<body>
  <header>
    <div class="navbutton sidebar">
      <a href="javascript:void(0);" onclick="openslidermenu()">
        <div id="traveller"><img src="../images/Andarilho menu.png" alt="Viajante fazendo trilha"></div>
        <div class="menutext">
          <span>MENU</span>
        </div>
      </a>
    </div>

    <div class="handnote">
      <span>COMPENDIO MULTIVERSAL</span>
      <span>CRIATURAS E MONSTROS</span>
    </div>

    <div class="navbutton myprofile">
      <a href="./cadastro.html">
        <img src="../images/sticky-notes 1.png" height="66px" width="66px" style="mix-blend-mode: lighten;"
          alt="Vetor de notas post-it">
        <div class="menutext">
          <span>Meu Perfil</span>
        </div>
      </a>
    </div>
  </header>

  <div id="dropmenu" class="slidermenu">
    <div class="filter">
      <div class="slidermenu-content">
        <div class="logo">
          <img src="../images/logo livro.png" alt="Logo do site">
        </div>

        <div class="sections">
          <div id="linews" class="section selected">
            <a href="javascript:void(0);" onclick="opendropmenunews()">
              Destaques
            </a>
          </div>
          <div id="subsectionsnews" class="subsections">
            <a href="../html/Sobre os catalogos.html">Sobre os catalogos</a>
            <a href="">Novidades</a>
          </div>

          <div id="licomp" class="section">
            <a href="javascript:void(0);" onclick="opendropmenucomp()">
              Compendio
            </a>
          </div>
          <div id="subsectionscomp" class="subsections">
            <a href="">Catalogos</a>
            <a href="">Estatisticas</a>
          </div>

          <!-- <div id="licamp" class="section">
                    <a href="javascript:void(0);" onclick="opendropmenucamp()">
                        Contos da Fogueira
                    </a>
                </div>
                <div id="subsectionscamp" class="subsections">
                    <a href="">a</a>
                    <a href="">b</a>
                </div> -->
        </div>
      </div>
    </div>
  </div>

  <div class="folder">
    <a href="./login.html" class="loginbutton">
      <img src="../images/Login button.png" height="108px" width="222px"
        alt="Seta diagonal para cima e direita para tela de login">
    </a>
    <div class="foldercover">
      <div class="coverinputs">
        <div class="title">
          Realize seu cadastro, faça parte da CCM e colabore com os registros!
        </div>
        <br><br>
        <div class="inpcamp">
          Nome do usuário: <br>
          <input type="text" name="" id="ipt_username">
          <div id="div_username" class="errortext"></div>
        </div>
        <div class="inpcamp">
          E-mail: <br>
          <input type="text" name="" id="ipt_useremail">
          <div id="div_useremail" class="errortext"></div>
        </div>
        <div class="inpcamp">
          Senha: <br>
          <input type="password" name="" id="ipt_userpasw">
          <div id="div_userpasw" class="errortext"></div>
        </div>
        <div class="inpcamp">
          Confirme senha: <br>
          <input type="password" name="" id="ipt_confirmpasw">
          <div id="div_confirmpasw" class="errortext"></div>
        </div>
      </div>
      <div class="coverstatus">
        <img src="../images/Carimbo logo.png" alt="Logo compendio estilo carimbo">
        <button onclick="cadastrar()">Cadastrar</button>
        <div id="signup" class="signupstatus"></div>
      </div>
    </div>
  </div>
</body>

</html>

<script src="../js/general.js"></script>
<script src="../js/folder.js"></script>

<script>

  window.onload = function validarId() {
    if(!sessionStorage == "" || !sessionStorage.ID_USUARIO == "") {
      alert("Seu login foi realizado com sucesso!");
    }
    
    alert("Cadê o seu id?");
  }

  // Array para armazenar empresas cadastradas para validação de código de ativação 
  let listaEmpresasCadastradas = [];

  function cadastrar() {
    // aguardar();

    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var nomeVar = ipt_username.value;
    var emailVar = ipt_useremail.value;
    var senhaVar = ipt_userpasw.value;
    var confirmacaoSenhaVar = ipt_confirmpasw.value;

    // Verificando se há algum campo em branco
    if (
      nomeVar == "" ||
      emailVar == "" ||
      senhaVar == "" ||
      confirmacaoSenhaVar == ""
    ) {
      alert("AQUI FICA AS VALIDACOES");
    } else {
      
      fetch("/usuarios/cadastrar", {
        method: "POST", // POST == INSERT E SELECT (COM ID POR EXEMPLO); GET == SELECT; PUT == UPDATE; DELETE == DELETE;
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          nomeServer: nomeVar,
          emailServer: emailVar,
          senhaServer: senhaVar
      }),
    })
    .then(function (resposta) {
      console.log("resposta: ", resposta);

      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        finalizarAguardar();
      });

    return false;
  }
  }
</script>